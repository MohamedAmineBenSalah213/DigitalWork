<!-- <pngx-page-header title="Users & Groups" i18n-title>
</pngx-page-header>

<ng-container ><!-- *ngIf="users" 
    <h4 class="d-flex">
        <ng-container i18n>Users</ng-container>
        <button type="button" class="btn btn-sm btn-outline-primary ms-4" (click)="editUser($event)" ><!-- *pngxIfPermissions="{ action: PermissionAction.Add, type: PermissionType.User }" 
        <svg class="sidebaricon me-1" fill="currentColor">
            <use xlink:href="assets/bootstrap-icons.svg#plus-circle" />
        </svg>
        <ng-container i18n>Add User</ng-container>
        </button>
    </h4>
    {{users}}
    <ul class="list-group">
        <li *ngFor="let user of users" class="list-group-item">
          <div>
            <strong>User Name:</strong> {{ user.userName }}
          </div>
          <div>
            <strong>First Name:</strong> {{ user.first_name || 'N/A' }}
          </div>
          <div>
            <strong>Last Name:</strong> {{ user.last_name || 'N/A' }}
          </div>
          <div>
            <strong>Date Joined:</strong> {{ user.normalizedUserName ? (user.date_joined | date: 'short') : 'N/A' }}
          </div>
          <div>
            <strong>Is Staff:</strong> {{ user.is_staff ? 'Yes' : 'No' }}
          </div>
          <div>
            <strong>Is Active:</strong> {{ user.is_active ? 'Yes' : 'No' }}
          </div>
          <div>
            <strong>Is Superuser:</strong> {{ user.is_superuser ? 'Yes' : 'No' }}
          </div>
          <div>
            <strong>Groups:</strong>
            <ul>
              <li *ngFor="let group of user.groups">{{ group }}</li>
            </ul>
          </div>
          <div>
            <strong>User Permissions:</strong>
            <ul>
              <li *ngFor="let permission of user.user_permissions">{{ permission }}</li>
            </ul>
          </div>
          <div>
            <strong>Inherited Permissions:</strong>
            <ul>
              <li *ngFor="let permission of user.inherited_permissions">{{ permission }}</li>
            </ul>
          </div>
        </li>
      </ul>
      
    <ul class="list-group">
        <li class="list-group-item">
        <div class="row">
            <div class="col" i18n>Username</div>
            <div class="col" i18n>Name</div>
            <div class="col" i18n>Groups</div>
            <div class="col" i18n>Actions</div>
        </div>
        </li>

        <li *ngFor="let user of users" class="list-group-item">
         
        <div class="row">
          <!-- <button class="btn btn-link p-0" type="button" (click)="editUser(user)"></button> 
            <div class="col d-flex align-items-center">{{user.userName}}</div><!--  [disabled]="!permissionsService.currentUserCan(PermissionAction.Change, PermissionType.User)" 
            <div class="col d-flex align-items-center">{{user.userName}} {{user.userName}}</div>
            <div class="col d-flex align-items-center">{{user.groups?.map(getGroupName, this).join(', ')}}</div>
            <div class="col">
            <div class="btn-group">
                <button class="btn btn-sm btn-outline-secondary" type="button" (click)="editUser(user)"><!--  *pngxIfPermissions="{ action: PermissionAction.Change, type: PermissionType.User }" 
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#pencil" />
                    </svg>&nbsp;<ng-container i18n>Edit</ng-container>
                </button>
                <button class="btn btn-sm btn-outline-danger" type="button" (click)="deleteUser(user)" ><!-- *pngxIfPermissions="{ action: PermissionAction.Delete, type: PermissionType.User }" 
                        <use xlink:href="assets/bootstrap-icons.svg#trash" />
                    </svg>&nbsp;<ng-container i18n>Delete</ng-container>
                </button>
            </div>
            </div>
        </div>
        </li>
    </ul>
</ng-container>

<ng-container ><!-- *ngIf="groups" 
    <h4 class="mt-4 d-flex">
        <ng-container i18n>Groups</ng-container>
        <button type="button" class="btn btn-sm btn-outline-primary ms-4" (click)="editGroup()" ><!-- *pngxIfPermissions="{ action: PermissionAction.Add, type: PermissionType.Group }" 
        <svg class="sidebaricon me-1" fill="currentColor">
            <use xlink:href="assets/bootstrap-icons.svg#plus-circle" />
        </svg>
        <ng-container i18n>Add Group</ng-container>
        </button>
    </h4>
    <ul *ngIf="groups.length > 0" class="list-group">
        <li class="list-group-item">
        <div class="row">
            <div class="col" i18n>Name</div>
            <div class="col"></div>
            <div class="col"></div>
            <div class="col" i18n>Actions</div>
        </div>
        </li>

        <li *ngFor="let group of groups" class="list-group-item">
        <div class="row">
            <div class="col d-flex align-items-center"><button class="btn btn-link p-0" type="button" (click)="editGroup(group)" [disabled]="!permissionsService.currentUserCan(PermissionAction.Change, PermissionType.Group)">{{group.name}}</button></div>
            <div class="col"></div>
            <div class="col"></div>
            <div class="col">
            <div class="btn-group">
                <button class="btn btn-sm btn-outline-secondary" type="button" (click)="editGroup(group)" *pngxIfPermissions="{ action: PermissionAction.Change, type: PermissionType.Group }">
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#pencil" />
                    </svg>&nbsp;<ng-container i18n>Edit</ng-container>
                </button>
                <button class="btn btn-sm btn-outline-danger" type="button" (click)="deleteGroup(group)" *pngxIfPermissions="{ action: PermissionAction.Delete, type: PermissionType.Group }">
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#trash" />
                    </svg>&nbsp;<ng-container i18n>Delete</ng-container>
                </button>
            </div>
            </div>
        </div>
        </li>
        <li *ngIf="groups.length === 0" class="list-group-item" i18n>No groups defined</li>
    </ul>

</ng-container>

<div *ngIf="!users || !groups">
    <div class="spinner-border spinner-border-sm fw-normal ms-2 me-auto" role="status"></div>
    <div class="visually-hidden" i18n>Loading...</div>
</div>
 -->
 <pngx-page-header title="Users & Groups" i18n-title>
</pngx-page-header>

<ng-container *ngIf="users">
    <h4 class="d-flex">
        <ng-container i18n>Users</ng-container>
        <button type="button" class="btn btn-sm btn-outline-primary ms-4" (click)="editUser()" ><!-- *pngxIfPermissions="{ action: PermissionAction.Add, type: PermissionType.User }" -->
        <svg class="sidebaricon me-1" fill="currentColor">
            <use xlink:href="assets/bootstrap-icons.svg#plus-circle" />
        </svg>
        <ng-container i18n>Add User</ng-container>
        </button>
    </h4>
    <ul class="list-group">
        <li class="list-group-item">
        <div class="row">
            <div class="col" i18n>Username</div>
            <div class="col" i18n>Email</div>
            <div class="col" i18n>Groups</div>
            <div class="col" i18n>Actions</div>
        </div>
        </li>

        <li *ngFor="let user of users" class="list-group-item">
        <div class="row">
            <div class="col d-flex align-items-center"><button class="btn btn-link p-0" type="button" (click)="editUser(user)">{{user.userName}}</button></div><!--  [disabled]="!permissionsService.currentUserCan(PermissionAction.Change, PermissionType.User)" -->
            <div class="col d-flex align-items-center">{{user.email}}</div>
            <div class="col d-flex align-items-center">{{user.groups?.map(getGroupName, this).join(', ')}}</div>
            <div class="col">
            <div class="btn-group">
                <button class="btn btn-sm btn-outline-secondary" type="button" (click)="editUser(user)"><!--  *pngxIfPermissions="{ action: PermissionAction.Change, type: PermissionType.User }" -->
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#pencil" />
                    </svg>&nbsp;<ng-container i18n>Edit</ng-container>
                </button>
                <button class="btn btn-sm btn-outline-danger" type="button" (click)="deleteUser(user)" ><!-- *pngxIfPermissions="{ action: PermissionAction.Delete, type: PermissionType.User }" -->
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#trash" />
                    </svg>&nbsp;<ng-container i18n>Delete</ng-container>
                </button>
            </div>
            </div>
        </div>
        </li>
    </ul>
</ng-container>

<!-- <ng-container  *ngIf="groups" >
    <h4 class="mt-4 d-flex">
        <ng-container i18n>Groups</ng-container>
        <button type="button" class="btn btn-sm btn-outline-primary ms-4" (click)="editGroup()"><!--  *pngxIfPermissions="{ action: PermissionAction.Add, type: PermissionType.Group }" 
        <svg class="sidebaricon me-1" fill="currentColor">
            <use xlink:href="assets/bootstrap-icons.svg#plus-circle" />
        </svg>
        <ng-container i18n>Add Group</ng-container>
        </button>
    </h4>
    <ul *ngIf="groups.length > 0" class="list-group">
        <li class="list-group-item">
        <div class="row">
            <div class="col" i18n>Name</div>
            <div class="col"></div>
            <div class="col"></div>
            <div class="col" i18n>Actions</div>
        </div>
        </li>

        <li *ngFor="let group of groups" class="list-group-item">
        <div class="row">
            <div class="col d-flex align-items-center"><button class="btn btn-link p-0" type="button" (click)="editGroup(group)" >{{group.name}}</button></div><!-- [disabled]="!permissionsService.currentUserCan(PermissionAction.Change, PermissionType.Group)" 
            <div class="col"></div>
            <div class="col"></div>
            <div class="col">
            <div class="btn-group">
                <button class="btn btn-sm btn-outline-secondary" type="button" (click)="editGroup(group)" ><!-- *pngxIfPermissions="{ action: PermissionAction.Change, type: PermissionType.Group }" 
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#pencil" />
                    </svg>&nbsp;<ng-container i18n>Edit</ng-container>
                </button>
                <button class="btn btn-sm btn-outline-danger" type="button" (click)="deleteGroup(group)"><!--  *pngxIfPermissions="{ action: PermissionAction.Delete, type: PermissionType.Group }" 
                    <svg class="buttonicon-sm" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#trash" />
                    </svg>&nbsp;<ng-container i18n>Delete</ng-container>
                </button>
            </div>
            </div>
        </div>
        </li>
        <li *ngIf="groups.length === 0" class="list-group-item" i18n>No groups defined</li>
    </ul>

</ng-container>
 -->
 <div *ngIf="!users "><!-- || !groups" -->
    <div class="spinner-border spinner-border-sm fw-normal ms-2 me-auto" role="status"></div>
    <div class="visually-hidden" i18n>Loading...</div>
</div>